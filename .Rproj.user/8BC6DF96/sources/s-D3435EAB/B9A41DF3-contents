---
title: "Prediction of Diabetes"
author: "Sridhar"
date: "August 8, 2018"
output: html_document
---

## Loading the required libraries
```{r setup, include=FALSE}
library(ggplot2)
```

## Load the data
```{r}
data = read.csv("diabetes.csv")
head(data)
```

## Correlations
```{r}
library(corrplot)
correlations <- cor(data)
corrplot(correlations, method="color")
```

## Visualizations
```{r}
pairs(data, col=data$Outcome)
```

## Logistic regression
```{r}
library(caTools)
set.seed(88)
split <- sample.split(data$Outcome, SplitRatio = 0.75)
```

```{r}
dresstrain <- subset(data, split == TRUE)
dresstest <- subset(data, split == FALSE)

```

```{r}
model <- glm (Outcome ~ .-Pregnancies + Glucose + BloodPressure + SkinThickness + Insulin + BMI + DiabetesPedigreeFunction + Age, data = dresstrain, family = binomial)
summary(model)
```

```{r}
predict <- predict(model, newdata = dresstest, type = 'response')
predict
```


```{r}
table(dresstrain$Outcome, predict > 0.5)
```

```{r}
library(ROCR)
ROCRpred <- prediction(predict, dresstrain$Outcome)
ROCRperf <- performance(ROCRpred, 'tpr','fpr')
plot(ROCRperf, colorize = TRUE, text.adj = c(-0.2,1.7))

```


```{r}
#plot glm

ggplot(dresstrain, aes(x=Glucose, y=Outcome)) + geom_point() + 
stat_smooth(method="glm", family="binomial", se=FALSE)
```

