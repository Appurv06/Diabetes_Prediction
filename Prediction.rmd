---
title: "Prediction of Diabetes"
author: "Sridhar"
date: "August 8, 2018"
output: 
  prettydoc::html_pretty:
    theme: cayman
    highlight: github
---

## Loading the required libraries
```{r}
library(ggplot2)
library(corrplot)
library(caTools)
library(ROCR)
```

## Load the data
The observations of the people are stored in a CSV format, named diabetes.csv.The data is loaded in the environment.Let's check how the data is structured.
```{r}
data = read.csv("diabetes.csv")
head(data)
```

## Correlations

The proportionalities of the attributes of the data can be identified by the  correlation coefficient,either numerically or visually.
```{r}
correlations <- cor(data)
correlations
corrplot(correlations, method="color")
```

## Visualizations
```{r}
pairs(data, col=data$Outcome)
```


## Preparing the data

The dataset is divided as two parts, training data and testing data, with a Splitratio of 0.75. It means that 2/3rds of the data is labelled by training set and the rest 1/3rd of data is the testing set.The division of the dataset is by means of a random order generated by the seed.
```{r}
set.seed(88)
split <- sample.split(data$Outcome, SplitRatio = 0.75)
data_train <- subset(data, split == TRUE)
data_test <- subset(data, split == FALSE)
```



## Logistic regression

The Logistic regression helps to classify the concern person will get diabetes or not in the near future.
```{r}
model <- glm (Outcome ~ .-Pregnancies + Glucose + BloodPressure + SkinThickness + Insulin + BMI + DiabetesPedigreeFunction + Age, data = data_train, family = binomial)
summary(model)
```

```{r}
predict_train <- predict(model, type = 'response')
predict_test <- predict(model, newdata = data_test, type = 'response')

```

```{r}
table(data_train$Outcome, predict_train > 0.5)
```

```{r}

ROCRpred <- prediction(predict_train, data_train$Outcome)
ROCRperf <- performance(ROCRpred, 'tpr','fpr')
plot(ROCRperf, colorize = TRUE, text.adj = c(-0.2,1.7))

```


